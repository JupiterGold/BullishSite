(self.webpackChunkjson_bot_ui=self.webpackChunkjson_bot_ui||[]).push([[8253],{8253:function(t,o,i){"use strict";i.r(o),i.d(o,{BotSetupPageModule:function(){return T}});var e=i(1116),n=i(1462),s=i(6611),r=i(2782),c=i(4762),a=i(8619),h=i(6907),l=i(2693),u=i(1779),g=i(8993);function d(t,o){if(1&t){const t=a.EpF();a.TgZ(0,"div",5),a.TgZ(1,"ion-icon",6),a.NdJ("click",function(o){return a.CHM(t),a.oxw().onDeleteBot(o)}),a.qZA(),a.qZA()}}function m(t,o){if(1&t&&(a.TgZ(0,"ion-row"),a.TgZ(1,"ion-col"),a._uU(2),a.ALo(3,"date"),a.qZA(),a.TgZ(4,"ion-col"),a._uU(5),a.qZA(),a.TgZ(6,"ion-col"),a._uU(7),a.qZA(),a.qZA()),2&t){const t=o.$implicit,i=a.oxw(2);a.xp6(2),a.Oqu(a.xi3(3,3,t.D,"dd/MM HH:mm")),a.xp6(3),a.Oqu(i.shortNumberDisplay(t.Q,1,3)),a.xp6(2),a.Oqu(t.P)}}function f(t,o){if(1&t){const t=a.EpF();a.TgZ(0,"div"),a.TgZ(1,"ion-item",7),a.TgZ(2,"span",0),a.TgZ(3,"ion-chip",8),a.NdJ("click",function(o){return a.CHM(t),a.oxw().onShowOutput(o)}),a._UZ(4,"ion-icon",9),a.TgZ(5,"ion-label"),a._uU(6,"transactions "),a.qZA(),a._UZ(7,"ion-icon",10),a.qZA(),a.qZA(),a.TgZ(8,"span",5),a.TgZ(9,"ion-chip",8),a.NdJ("click",function(o){return a.CHM(t),a.oxw().onDeleteOutput(o)}),a._UZ(10,"ion-icon",11),a.TgZ(11,"ion-label"),a._uU(12,"init bot "),a.qZA(),a._UZ(13,"ion-icon",10),a.qZA(),a.qZA(),a.qZA(),a.TgZ(14,"ion-grid",12),a.TgZ(15,"ion-row"),a.TgZ(16,"ion-col"),a._uU(17,"Date"),a.qZA(),a.TgZ(18,"ion-col"),a._uU(19,"Qty"),a.qZA(),a.TgZ(20,"ion-col"),a._uU(21,"Price"),a.qZA(),a.qZA(),a.YNc(22,m,8,6,"ion-row",13),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(22),a.Q6J("ngForOf",t.oT)}}const p=["","K","M","B","T","Q"],Z=[{path:"",component:(()=>{class t{constructor(t,o,i,e,n){this.oLocation=t,this.oAPIService=o,this.http=i,this.router=e,this.oStorage=n,this.sExchange="<notSet>",this.sStrategy="<notSet>",this.sKey=void 0,this.sTitle=void 0,this.bLoaded=!1,this.bNew=!0,this.oT=[];var s=this.oLocation.getState();console.log(s),this.bNew=s.isNew,null==s||s.isNew||(this.sStrategy=s.Strategy,this.sExchange=s.Exchange,this.sKey=this.getKey(s),console.log(this.sKey),this.oP=s,this.updateValues(s)),null!=s&&s.isNew&&(this.sStrategy=s.Strategy,this.sExchange=s.Exchange,console.log("New Bot Configuration:",this.sStrategy)),this.sTitle=this.getTitle(s)}onBack(){return(0,c.mG)(this,void 0,void 0,function*(){this.oLocation.back()})}getKey(t){return this.sExchange+"_"+this.sStrategy+"_"+t.A+t.B}getTitle(t){return this.sExchange+"_"+this.sStrategy}shortNumberDisplay(t,o,i){if(0===t)return t;const e=Math.floor(Math.log10(Math.abs(t))/3),n=p[e];return(t/Math.pow(10,3*e)).toLocaleString(void 0,{minimumFractionDigits:o,maximumFractionDigits:i})+n}readParameters(t){return(0,c.mG)(this,void 0,void 0,function*(){this.oP=yield this.oStorage.get(t),this.updateValues(this.oP)})}ngOnInit(){this.http.get("/assets/strategy-"+this.sStrategy+".json").subscribe(t=>(0,c.mG)(this,void 0,void 0,function*(){this.formData=t,this.updateValues(this.oP)}))}updateValues(t){if(void 0===t||null==t||null==this.formData)return;if(this.bLoaded)return;this.bLoaded=!0,console.log(this.oP);let o=this.formData.controls.length,i=Object.keys(t);for(var e=0;e<i.length;e++){let n=i[e];for(let i=0;i<o;i++)this.formData.controls[i].name==n&&(this.formData.controls[i].value=t[n])}console.log(this.formData.controls)}onDeleteBot(t){return(0,c.mG)(this,void 0,void 0,function*(){yield this.oAPIService.send2ServerPDelete("bot-config/"+this.getKey(this.oP)).then(t=>(0,c.mG)(this,void 0,void 0,function*(){void 0!==this.sKey&&(yield this.oStorage.remove(this.sKey)),yield this.router.navigateByUrl("bot-list")}))})}onDeleteOutput(t){return(0,c.mG)(this,void 0,void 0,function*(){console.log(t),yield this.oAPIService.send2ServerPDelete("output/"+this.getKey(this.oP))})}getDecimalPlaces(t){const o=String(t);return o.includes(".")?o.split(".")[1].length:0}onShowOutput(t){return(0,c.mG)(this,void 0,void 0,function*(){this.oT=[],yield this.oAPIService.send2ServerP("output/"+this.getKey(this.oP)).then(t=>(0,c.mG)(this,void 0,void 0,function*(){if(void 0===t||void 0===t.T)return;let o=t.T.length;for(var i=0;i<o;i++){if("FILLED"!=t.T[i].Status)continue;let o=t.T[i].D,e=this.getDecimalPlaces(t.T[i].Q),n=this.getDecimalPlaces(t.T[i].P);e=n<3?Math.min(e+n,7):Math.min(e,0),this.oT.push({D:o,Q:t.T[i].Q.toFixed(e),P:t.T[i].P.toFixed(Math.min(n,8)),$:Number(t.T[i].Q)*Number(t.T[i].P)})}}))})}onFormSubmit(t){return(0,c.mG)(this,void 0,void 0,function*(){this.bNew&&(t.Exchange=this.sExchange),console.log(t.Exchange,this.sExchange),this.sKey=this.getKey(t),console.log(this.sKey),this.oStorage.set(this.sKey,t),console.log(t),yield this.oAPIService.send2ServerP("bot-config",!0,t),yield this.router.navigateByUrl("bot-list")})}}return t.\u0275fac=function(o){return new(o||t)(a.Y36(e.Ye),a.Y36(h.D),a.Y36(l.eN),a.Y36(r.F0),a.Y36(u.V))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-bot-setup"]],decls:11,vars:4,consts:[["slot","start"],["slot","end",4,"ngIf"],[1,"ion-padding"],[3,"jsonFormData","formSubmission"],[4,"ngIf"],["slot","end"],["name","trash",3,"click"],["item-end",""],[3,"click"],["name","albums","color","primary"],["color","primary"],["name","close","color","primary"],[1,"ion-margin"],[4,"ngFor","ngForOf"]],template:function(t,o){1&t&&(a.TgZ(0,"ion-header"),a.TgZ(1,"ion-toolbar"),a.TgZ(2,"ion-title"),a._uU(3),a.qZA(),a.TgZ(4,"ion-buttons",0),a._UZ(5,"ion-back-button"),a.qZA(),a.YNc(6,d,2,0,"div",1),a.qZA(),a.qZA(),a.TgZ(7,"ion-content",2),a.TgZ(8,"div"),a.TgZ(9,"app-json-form",3),a.NdJ("formSubmission",function(t){return o.onFormSubmit(t)}),a.qZA(),a.qZA(),a.YNc(10,f,23,1,"div",4),a.qZA()),2&t&&(a.xp6(3),a.Oqu(o.sTitle),a.xp6(3),a.Q6J("ngIf",void 0!==o.sKey),a.xp6(3),a.Q6J("jsonFormData",o.formData),a.xp6(1),a.Q6J("ngIf",void 0!==o.sKey))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.oU,s.cs,e.O5,s.W2,g.u,s.gu,s.Ie,s.hM,s.Q$,s.jY,s.Nd,s.wI,e.sg],pipes:[e.uU],styles:["ion-col[_ngcontent-%COMP%]{text-align:right}ion-icon[_ngcontent-%COMP%]{margin:10px;font-size:large}"]}),t})()}];let v=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[r.Bz.forChild(Z)],r.Bz]}),t})();var y=i(6737);let T=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[e.ez,n.UX,s.Pc,v,l.JF,y.G]]}),t})()}}]);