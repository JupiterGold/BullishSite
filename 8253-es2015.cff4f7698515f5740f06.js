(self.webpackChunkjson_bot_ui=self.webpackChunkjson_bot_ui||[]).push([[8253],{8253:function(t,o,e){"use strict";e.r(o),e.d(o,{BotSetupPageModule:function(){return v}});var s=e(1116),i=e(1462),n=e(6611),r=e(2782),a=e(4762),h=e(8619),c=e(6907),l=e(2693),u=e(1779),g=e(8993);function d(t,o){if(1&t){const t=h.EpF();h.TgZ(0,"div",4),h.TgZ(1,"ion-button",5),h.NdJ("click",function(o){return h.CHM(t),h.oxw().onDeleteBot(o)}),h._uU(2,"Delete"),h.qZA(),h.qZA()}}const f=[{path:"",component:(()=>{class t{constructor(t,o,e,s,i){this.oLocation=t,this.oAPIService=o,this.http=e,this.router=s,this.oStorage=i,this.sExchange="<notSet>",this.sStrategy="<notSet>",this.sKey=void 0,this.bLoaded=!1,this.bNew=!0;var n=this.oLocation.getState();console.log(n),this.bNew=n.isNew,null==n||n.isNew||(this.sStrategy=n.Strategy,this.sExchange=n.Exchange,this.sKey=this.getKey(n),console.log(this.sKey),this.oP=n,this.updateValues(n)),null!=n&&n.isNew&&(this.sStrategy=n.Strategy,this.sExchange=n.Exchange,console.log("New Bot Configuration:",this.sStrategy))}onBack(){return(0,a.mG)(this,void 0,void 0,function*(){this.oLocation.back()})}getKey(t){return this.sExchange+"_"+this.sStrategy+"_"+t.A+t.B}readParameters(t){return(0,a.mG)(this,void 0,void 0,function*(){this.oP=yield this.oStorage.get(t),this.updateValues(this.oP)})}ngOnInit(){this.http.get("/assets/strategy-"+this.sStrategy+".json").subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){this.formData=t,this.updateValues(this.oP)}))}updateValues(t){if(void 0===t||null==t||null==this.formData)return;if(this.bLoaded)return;this.bLoaded=!0,console.log(this.oP);let o=this.formData.controls.length,e=Object.keys(t);for(var s=0;s<e.length;s++){let i=e[s];for(let e=0;e<o;e++)this.formData.controls[e].name==i&&(this.formData.controls[e].value=t[i])}console.log(this.formData.controls)}onDeleteBot(t){return(0,a.mG)(this,void 0,void 0,function*(){yield this.oAPIService.send2ServerPDelete("bot-config/"+this.getKey(this.oP)).then(t=>(0,a.mG)(this,void 0,void 0,function*(){void 0!==this.sKey&&(yield this.oStorage.remove(this.sKey)),yield this.router.navigateByUrl("bot-list")}))})}onFormSubmit(t){return(0,a.mG)(this,void 0,void 0,function*(){this.bNew&&(t.Exchange=this.sExchange),console.log(t.Exchange,this.sExchange),this.sKey=this.getKey(t),console.log(this.sKey),this.oStorage.set(this.sKey,t),console.log(t),yield this.oAPIService.send2ServerP("bot-config",!0,t),yield this.router.navigateByUrl("bot-list")})}}return t.\u0275fac=function(o){return new(o||t)(h.Y36(s.Ye),h.Y36(c.D),h.Y36(l.eN),h.Y36(r.F0),h.Y36(u.V))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-bot-setup"]],decls:9,vars:2,consts:[["slot","start"],["slot","end",4,"ngIf"],[1,"ion-padding"],[3,"jsonFormData","formSubmission"],["slot","end"],[3,"click"]],template:function(t,o){1&t&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-title"),h._uU(3,"Bot Configuration"),h.qZA(),h.TgZ(4,"ion-buttons",0),h._UZ(5,"ion-back-button"),h.qZA(),h.YNc(6,d,3,0,"div",1),h.qZA(),h.qZA(),h.TgZ(7,"ion-content",2),h.TgZ(8,"app-json-form",3),h.NdJ("formSubmission",function(t){return o.onFormSubmit(t)}),h.qZA(),h.qZA()),2&t&&(h.xp6(6),h.Q6J("ngIf",void 0!==o.sKey),h.xp6(2),h.Q6J("jsonFormData",o.formData))},directives:[n.Gu,n.sr,n.wd,n.Sm,n.oU,n.cs,s.O5,n.W2,g.u,n.YG],styles:[""]}),t})()}];let m=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[r.Bz.forChild(f)],r.Bz]}),t})();var y=e(6737);let v=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[s.ez,i.UX,n.Pc,m,l.JF,y.G]]}),t})()}}]);